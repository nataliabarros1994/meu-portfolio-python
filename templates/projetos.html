{% extends 'base.html' %}

{% block title %}Projetos - {{ nome_portfolio }}{% endblock %}

{% block content %}
<!-- Page Header -->
<section class="page-header bg-primary text-white">
    <div class="container">
        <div class="row align-items-center py-5">
            <div class="col-lg-8">
                <h1 class="display-4 fw-bold mb-3">Meus Projetos</h1>
                <p class="lead mb-0">Explore meu trabalho e veja como transformo ideias em realidade</p>
            </div>
            <div class="col-lg-4 text-lg-end">
                <div class="stats-badge">
                    <h3 class="fw-bold mb-0">{{ projetos|length }}</h3>
                    <p class="mb-0">Projetos desenvolvidos</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Filtros e Busca -->
<section class="py-4 bg-light border-bottom">
    <div class="container">
        <div class="row g-3 align-items-center">
            <!-- Busca -->
            <div class="col-lg-5">
                <form action="{{ url_for('projetos') }}" method="get" class="search-form">
                    <div class="input-group">
                        <input type="text"
                               class="form-control"
                               name="busca"
                               placeholder="Buscar projetos..."
                               value="{{ busca or '' }}">
                        <button class="btn btn-primary" type="submit">
                            <i class="bi bi-search"></i> Buscar
                        </button>
                    </div>
                </form>
            </div>

            <!-- Filtro por Categoria -->
            <div class="col-lg-4">
                <select class="form-select" onchange="filtrarPorCategoria(this.value)">
                    <option value="todas" {% if not categoria_atual %}selected{% endif %}>
                        Todas as categorias
                    </option>
                    {% for cat in categorias %}
                    <option value="{{ cat }}" {% if categoria_atual == cat %}selected{% endif %}>
                        {{ cat }}
                    </option>
                    {% endfor %}
                </select>
            </div>

            <!-- Limpar Filtros -->
            <div class="col-lg-3 text-end">
                {% if busca or categoria_atual %}
                <a href="{{ url_for('projetos') }}" class="btn btn-outline-secondary">
                    <i class="bi bi-x-circle"></i> Limpar Filtros
                </a>
                {% endif %}
            </div>
        </div>
    </div>
</section>

<!-- Lista de Projetos -->
<section class="py-5">
    <div class="container">
        {% if projetos %}
        <!-- Resultados -->
        {% if busca %}
        <div class="alert alert-info mb-4">
            <i class="bi bi-info-circle"></i>
            Encontrados <strong>{{ projetos|length }}</strong> resultado(s) para "<strong>{{ busca }}</strong>"
        </div>
        {% endif %}

        <div class="row g-4">
            {% for projeto in projetos %}
            <div class="col-md-6 col-lg-4" data-aos="fade-up" data-aos-delay="{{ loop.index * 50 }}">
                <div class="project-card h-100">
                    <div class="project-image">
                        <img src="{{ url_for('static', filename='images/' + projeto.imagem) }}"
                             alt="{{ projeto.titulo }}"
                             onerror="this.src='https://via.placeholder.com/400x250/007bff/ffffff?text={{ projeto.titulo }}'">
                        <div class="project-overlay">
                            <a href="{{ url_for('projeto_detalhe', id=projeto.id) }}" class="btn btn-light">
                                <i class="bi bi-eye"></i> Ver Detalhes
                            </a>
                        </div>
                        {% if projeto.destaque %}
                        <span class="badge bg-warning position-absolute top-0 end-0 m-3">
                            <i class="bi bi-star-fill"></i> Destaque
                        </span>
                        {% endif %}
                    </div>
                    <div class="project-content">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <span class="badge bg-primary-subtle text-primary">{{ projeto.categoria }}</span>
                            <small class="text-muted">
                                <i class="bi bi-calendar3"></i>
                                {{ projeto.data_criacao.strftime('%d/%m/%Y') }}
                            </small>
                        </div>
                        <h4 class="project-title">{{ projeto.titulo }}</h4>
                        <p class="project-description">
                            {{ projeto.descricao_curta or projeto.descricao[:120] + '...' }}
                        </p>
                        <div class="project-tech mb-3">
                            {% for tech in projeto.tecnologias.split(',')[:4] %}
                            <span class="tech-badge">{{ tech.strip() }}</span>
                            {% endfor %}
                        </div>
                        <div class="project-links">
                            {% if projeto.github_url %}
                            <a href="{{ projeto.github_url }}" target="_blank" class="btn btn-sm btn-outline-dark me-2">
                                <i class="bi bi-github"></i> Código
                            </a>
                            {% endif %}
                            {% if projeto.demo_url %}
                            <a href="{{ projeto.demo_url }}" target="_blank" class="btn btn-sm btn-outline-primary">
                                <i class="bi bi-box-arrow-up-right"></i> Demo
                            </a>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>

        {% else %}
        <!-- Nenhum resultado -->
        <div class="text-center py-5">
            <i class="bi bi-folder2-open display-1 text-muted"></i>
            <h3 class="mt-4 mb-3">Nenhum projeto encontrado</h3>
            {% if busca or categoria_atual %}
            <p class="text-muted mb-4">Tente ajustar seus filtros de busca</p>
            <a href="{{ url_for('projetos') }}" class="btn btn-primary">
                Ver Todos os Projetos
            </a>
            {% else %}
            <p class="text-muted mb-4">Ainda não há projetos cadastrados</p>
            <a href="{{ url_for('add_project') }}" class="btn btn-primary">
                Adicionar Primeiro Projeto
            </a>
            {% endif %}
        </div>
        {% endif %}
    </div>
</section>

<!-- Call to Action -->
<section class="py-5 bg-light">
    <div class="container text-center">
        <h3 class="fw-bold mb-3">Interessado em trabalhar comigo?</h3>
        <p class="text-muted mb-4">Estou sempre aberta a discutir novos projetos e oportunidades criativas</p>
        <a href="{{ url_for('contato') }}" class="btn btn-primary btn-lg">
            <i class="bi bi-envelope"></i> Vamos Conversar
        </a>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script>
function filtrarPorCategoria(categoria) {
    const urlParams = new URLSearchParams(window.location.search);

    if (categoria === 'todas') {
        urlParams.delete('categoria');
    } else {
        urlParams.set('categoria', categoria);
    }

    window.location.search = urlParams.toString();
}

// AOS Animation
document.addEventListener('DOMContentLoaded', function() {
    if (typeof AOS !== 'undefined') {
        AOS.init({
            duration: 600,
            once: true
        });
    }
});
</script>
<script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
<link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
{% endblock %}
